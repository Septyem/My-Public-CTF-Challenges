NN-based hash with some forward propagation things
